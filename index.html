<!DOCTYPE html>
<html>

<head>
	<title>Hello World</title>
</head>

<body>
	<h1>Hello World</h1>
	<p>Number of deployments for today: <span id="deployments"></span></p>
	<p>Seconds since page load: <span id="seconds"></span></p>

	<script>
		async function updateDeployments() {
		  const xhr = new XMLHttpRequest();
		  xhr.open('GET', '/usr/share/nginx/html/app/conf.txt');
		  xhr.onload = () => {
		    if (xhr.status === 200) {
		      const deployments = xhr.responseText;
		      document.getElementById("deployments").innerHTML = deployments;
		    } else {
		      console.warn("Failed to load conf.txt");
		    }
		  };
		  xhr.send();
		}

		function updateSeconds() {
			// Get the current timestamp in seconds
			var timestamp = Math.floor(Date.now() / 1000);

			var date = new Date(timestamp * 1000); // Convert to milliseconds
			var formattedDate = date.toLocaleString(); // Format as a string in the user's local timezone

			// Update the text of the span element with id "seconds"
			document.getElementById("seconds").innerHTML = formattedDate;
		}

		// Call the updateDeployments and updateSeconds functions initially
		updateDeployments();
		updateSeconds();

		// Update the deployments every 5 seconds
		setInterval(updateDeployments, 5000);

		// Update the seconds every second
		setInterval(updateSeconds, 1000);
	</script>
</body>

</html>
